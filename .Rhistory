length(gg_avg)
plt_name = "Avg Emotion Intensity by Area of Contact"
save3ggplt(gg_avg, plt_name, plt_path)
length(gg_pct)
plt_name = "Percent of Emotions by Area of Contact"
save3ggplt(gg_pct, plt_name, plt_path)
####### avg intensity & pct of emotions by product size #######
# plot
ggplts = plt_avg_intensity(dat, "product_size", barlab_at_top=T)
gg_avg = ggplts[["plts_avg"]]
gg_pct = ggplts[["plts_pct"]]
# save plot
length(gg_avg)
plt_name = "Avg Emotion Intensity by Product Size"
save2ggplt(gg_avg, plt_name, plt_path)
length(gg_pct)
plt_name = "Percent of Emotions by Product Size"
save2ggplt(gg_pct, plt_name, plt_path)
##### emotion intensity over time for each study arm #########
plt = mk_lineplot(dat)
title = "Intensity Over Time"
p = plt("event_apex", "intensity", fillby="study_arm", xlab="apex time (in sec)",
ylab = "emotional intensity", main=title)
p = p + ggplot2::scale_x_continuous(limit=c(0, 300), breaks=seq(0, 300, 15))
p = rotate_axis_text(p, 15)
filename = paste(title, "png", sep=".")
ggsave(plot=p, file=file.path(plt_path, filename), height=4, width=10)
##### emotion intensity over time by emotion (for each study arm) ######
dat = left_join(dat, dict_emo_col)
temp = unique(dat[, c("event", "color")])
temp = temp %>% arrange(event)
title = "Intensity Over Time for Each Emotion"
p = ggplot(dat, aes(x=event_apex, y=intensity)) +
facet_grid( . ~ study_arm) + geom_point(aes(color=event), size=3) +
geom_line(aes(y=intensity, group=event, color=event), size=1.5, alpha=0.8) +
scale_color_manual(values = temp$color) + theme_bw() +
labs(x="apex time in seconds", y="emotional intensity", main=title) +
scale_x_continuous(limit=c(0, 300), breaks=seq(0, 300, 30)) +
theme(axis.text.x = element_text(angle=15))
filename = paste(title, "png", sep=".")
ggsave(plot=p, file=file.path(plt_path, filename), height=4, width=10)
### count of events by study arm (Not Broken Down by Emotion) ######
# plot
p = plt_event_cnt2(dat, "study_arm")
# save plot
plt_name = "Event Count by Study Arm (Not Broken Down by Emotion)"
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
### count of events by event relationship to exposure (Not Broken Down by Emotion) ######
# plot
p = plt_event_cnt2(dat, "event_relationship")
# save plot
plt_name = "Event Count by Event Relationship (Not Broken Down by Emotion)"
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
### count of events by area of contact (Not Broken Down by Emotion) ######
# plot
p = plt_event_cnt2(dat, "area_of_contact")
# save plot
plt_name = "Event Count by Area of Contact (Not Broken Down by Emotion)"
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
### count of events by product size (Not Broken Down by Emotion) ######
# plot
p = plt_event_cnt2(dat, "product_size")
# save plot
plt_name = "Event Count by Product Size (Not Broken Down by Emotion)"
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
## avg intensity & pct of emotions by study arm (Not Broken Down by Emotion) ###
# plot
ggplts = plt_avg_intensity2(dat, "study_arm", barlab_at_top=T)
gg_avg = ggplts[["plts_avg"]]
gg_pct = ggplts[["plts_pct"]]
# save plot
plt_name = "Avg Emotion Intensity by Study Arm (Not Broken Down by Emotion)"
ggsave(plot=gg_avg, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
plt_name = "Percent of Emotions by Study Arm (Not Broken Down by Emotion)"
ggsave(plot=gg_pct, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
## avg intensity & pct of emotions by event relationship (Not Broken Down by Emotion) ###
# plot
ggplts = plt_avg_intensity2(dat, "event_relationship", barlab_at_top=T)
gg_avg = ggplts[["plts_avg"]]
gg_pct = ggplts[["plts_pct"]]
# save plot
plt_name = "Avg Emotion Intensity by Event Relationship (Not Broken Down By Emotion)"
ggsave(plot=gg_avg, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
plt_name = "Percent of Emotions by Event Relationship (Not Broken Down By Emotion)"
ggsave(plot=gg_pct, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
## avg intensity & pct of emotions by area of contact (Not Broken Down By Emotion) ##
# plot
ggplts = plt_avg_intensity2(dat, "area_of_contact", barlab_at_top=T)
gg_avg = ggplts[["plts_avg"]]
gg_pct = ggplts[["plts_pct"]]
# save plot (ignore "None (for image)")
plt_name = "Avg Emotion Intensity by Area of Contact (Not Broken Down By Emotion)"
ggsave(plot=gg_avg, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
plt_name = "Percent of Emotions by Area of Contact (Not Broken Down By Emotion)"
ggsave(plot=gg_pct, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
## avg intensity & pct of emotions by product size (Not Broken Down By Emotion) ##
# plot
ggplts = plt_avg_intensity2(dat, "product_size", barlab_at_top=T)
gg_avg = ggplts[["plts_avg"]]
gg_pct = ggplts[["plts_pct"]]
# save plot
plt_name = "Avg Emotion Intensity by Product Size (Not Broken Down By Emotion)"
ggsave(plot=gg_avg, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
plt_name = "Percent of Emotions by Product Size (Not Broken Down By Emotion)"
ggsave(plot=gg_pct, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# distribution of events
tbl = prep_data4(dat, "event")
plt = mk_barplot(tbl)
plt_name = "Overall Distribution of Events"
p = barplt(tbl, xvar="event", yvar="pct", fillby="event", ylab="percent",
main=plt_name, barlab="pct", barlab_size=4, barlab_at_top=T,
barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.5, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# distribution of study arm
tbl = prep_data4(dat, "study_arm")
plt = mk_barplot(tbl)
plt_name = "Overall Distribution of Study Arm"
p = barplt(tbl, xvar="study_arm", yvar="pct", fillby="study_arm", ylab="percent",
main=plt_name, barlab="pct", barlab_size=4, barlab_at_top=T,
barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.7, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# distribution of event relationship
tbl = prep_data4(dat, "event_relationship")
plt = mk_barplot(tbl)
plt_name = "Overall Distribution of Event Relationship"
p = barplt(tbl, xvar="event_relationship", yvar="pct",
fillby="event_relationship", ylab="percent",
main=plt_name, barlab="pct", barlab_size=4, barlab_at_top=T,
barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=1, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# distribution of area of contact
tbl = prep_data4(dat, "area_of_contact")
plt = mk_barplot(tbl)
plt_name = "Overall Distribution of Area of Contact"
p = barplt(tbl, xvar="area_of_contact", yvar="pct", fillby="area_of_contact",
ylab="percent", main=plt_name, barlab="pct", barlab_size=4,
barlab_at_top=T, barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.7, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# distribution of treatment
tbl = prep_data4(dat, "treatment")
plt = mk_barplot(tbl)
plt_name = "Overall Distribution of Treatment"
p = barplt(tbl, xvar="treatment", yvar="pct", fillby="treatment", ylab="percent",
main=plt_name, barlab="pct", barlab_size=4, barlab_at_top=T,
barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.7, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# distribution of product size
tbl = prep_data4(dat, "product_size")
plt = mk_barplot(tbl)
plt_name = "Overall Distribution of Product Size"
p = barplt(tbl, xvar="product_size", yvar="pct", fillby="product_size",
ylab="percent", main=plt_name, barlab="pct", barlab_size=4,
barlab_at_top=T, barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=1, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# percent of unique subjects by event
tbl = prep_data5(dat, "event")
plt = mk_barplot(tbl)
plt_name = "Percent of Unique Subjects by Event"
p = barplt(tbl, xvar="event", yvar="pct", fillby="event", ylab="percent",
main=plt_name, barlab="pct", barlab_size=4, barlab_at_top=T,
barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.7, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# percent of unique subjects by study arm
tbl = prep_data5(dat, "study_arm")
plt = mk_barplot(tbl)
plt_name = "Percent of Unique Subjects by Study Arm"
p = barplt(tbl, xvar="study_arm", yvar="pct", fillby="study_arm", ylab="percent",
main=plt_name, barlab="pct", barlab_size=4, barlab_at_top=T,
barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.7, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# percent of unique subjects by event relationship to exposure
tbl = prep_data5(dat, "event_relationship")
plt = mk_barplot(tbl)
plt_name = "Percent of Unique Subjects by Event Relationship"
p = barplt(tbl, xvar="event_relationship", yvar="pct",
fillby="event_relationship", ylab="percent", main=plt_name,
barlab="pct", barlab_size=4, barlab_at_top=T, barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=1, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# percent of unique subjects by area of contact
tbl = prep_data5(dat, "area_of_contact")
plt = mk_barplot(tbl)
plt_name = "Percent of Unique Subjects by Area of Contact"
p = barplt(tbl, xvar="area_of_contact", yvar="pct", fillby="area_of_contact",
ylab="percent", main=plt_name, barlab="pct", barlab_size=4,
barlab_at_top=T, barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.7, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# percent of unique subjects by treatment
tbl = prep_data5(dat, "treatment")
plt = mk_barplot(tbl)
plt_name = "Percent of Unique Subjects by Treatment"
p = barplt(tbl, xvar="treatment", yvar="pct", fillby="treatment", ylab="percent",
main=plt_name, barlab="pct", barlab_size=4, barlab_at_top=T,
barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.7, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# percent of unique subjects by product size
tbl = prep_data5(dat, "product_size")
plt = mk_barplot(tbl)
plt_name = "Percent of Unique Subjects by Product Size"
p = barplt(tbl, xvar="product_size", yvar="pct", fillby="product_size",
ylab="percent", main=plt_name, barlab="pct", barlab_size=4,
barlab_at_top=T, barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=1, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# rmasterve all R objects in the working directory
rm(list=ls())
library(dplyr)
library(tidyr)
library(ggplot2)
# set path
proj_path = "~/Projects/54_steve_t/2015/clr015002"
out_path = file.path(proj_path, "output")
v_path = file.path(out_path, "v2")
plt_path = file.path(v_path, "plot")
dir.create(plt_path, showWarnings = F)
helper_path = file.path(proj_path, "helper")
# source helper file
source(file.path(helper_path, "plt-helper.R"))
source(file.path(helper_path, "multiplot.R"))
source(file.path(helper_path, "plt-event-cnt.R"))
source(file.path(helper_path, "plt-event-cnt2.R"))
source(file.path(helper_path, "plt-avg-intensity.R"))
source(file.path(helper_path, "plt-avg-intensity2.R"))
# read data
options(stringsAsFactors=FALSE)
dat = read.csv(file.path(v_path, "final_v2.csv"), header=T,
na.strings=c("", " ", "NA"))
str(dat)
######## count of events by study arm #######
# plot
ggplts = plt_event_cnt(dat, "study_arm")
length(ggplts)
plt_name = "Event Count by Study Arm"
save3ggplt(ggplts, plt_name, plt_path)
ggplts = plt_event_cnt(dat, "event_relationship")
length(ggplts)
# save plot
plt_name = "Event Count by Event Relationship"
save2ggplt(ggplts, plt_name, plt_path)
ggplts = plt_event_cnt(dat, "area_of_contact")
length(ggplts)
# save plot (ignore the last plot, which is for "None (for image)")
plt_name = "Event Count by Area of Contact"
save3ggplt(ggplts, plt_name, plt_path)
ggplts = plt_event_cnt(dat, "product_size")
length(ggplts)
# save plot
plt_name = "Event Count by Product Size"
save2ggplt(ggplts, plt_name, plt_path)
ggplts = plt_avg_intensity(dat, "study_arm", barlab_at_top=T)
gg_avg = ggplts[["plts_avg"]]
gg_pct = ggplts[["plts_pct"]]
# save plot
length(gg_avg)
plt_name = "Avg Emotion Intensity by Study Arm"
save3ggplt(gg_avg, plt_name, plt_path)
length(gg_avg)
gg_avg
length(gg_pct)
plt_name = "Percent of Emotions by Study Arm"
save3ggplt(gg_pct, plt_name, plt_path)
ggplts = plt_avg_intensity(dat, "event_relationship", barlab_at_top=T)
gg_avg = ggplts[["plts_avg"]]
gg_pct = ggplts[["plts_pct"]]
# save plot
length(gg_avg)
plt_name = "Avg Emotion Intensity by Event Relationship"
save2ggplt(gg_avg, plt_name, plt_path)
length(gg_pct)
plt_name = "Percent of Emotions by Event Relationship"
save2ggplt(gg_pct, plt_name, plt_path)
ggplts = plt_avg_intensity(dat, "area_of_contact")
gg_avg = ggplts[["plts_avg"]]
gg_pct = ggplts[["plts_pct"]]
# save plot (ignore the last plot, which is for "None (for image)")
length(gg_avg)
plt_name = "Avg Emotion Intensity by Area of Contact"
save3ggplt(gg_avg, plt_name, plt_path)
length(gg_pct)
plt_name = "Percent of Emotions by Area of Contact"
save3ggplt(gg_pct, plt_name, plt_path)
ggplts = plt_avg_intensity(dat, "product_size", barlab_at_top=T)
gg_avg = ggplts[["plts_avg"]]
gg_pct = ggplts[["plts_pct"]]
# save plot
length(gg_avg)
plt_name = "Avg Emotion Intensity by Product Size"
save2ggplt(gg_avg, plt_name, plt_path)
length(gg_pct)
plt_name = "Percent of Emotions by Product Size"
save2ggplt(gg_pct, plt_name, plt_path)
plt = mk_lineplot(dat)
title = "Intensity Over Time"
p = plt("event_apex", "intensity", fillby="study_arm", xlab="apex time (in sec)",
ylab = "emotional intensity", main=title)
p = p + ggplot2::scale_x_continuous(limit=c(0, 300), breaks=seq(0, 300, 15))
p = rotate_axis_text(p, 15)
filename = paste(title, "png", sep=".")
ggsave(plot=p, file=file.path(plt_path, filename), height=4, width=10)
dat = left_join(dat, dict_emo_col)
temp = unique(dat[, c("event", "color")])
temp = temp %>% arrange(event)
title = "Intensity Over Time for Each Emotion"
p = ggplot(dat, aes(x=event_apex, y=intensity)) +
facet_grid( . ~ study_arm) + geom_point(aes(color=event), size=3) +
geom_line(aes(y=intensity, group=event, color=event), size=1.5, alpha=0.8) +
scale_color_manual(values = temp$color) + theme_bw() +
labs(x="apex time in seconds", y="emotional intensity", main=title) +
scale_x_continuous(limit=c(0, 300), breaks=seq(0, 300, 30)) +
theme(axis.text.x = element_text(angle=15))
filename = paste(title, "png", sep=".")
ggsave(plot=p, file=file.path(plt_path, filename), height=4, width=10)
p = plt_event_cnt2(dat, "study_arm")
# save plot
plt_name = "Event Count by Study Arm (Not Broken Down by Emotion)"
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
### count of events by event relationship to exposure (Not Broken Down by Emotion) ######
# plot
p = plt_event_cnt2(dat, "event_relationship")
# save plot
plt_name = "Event Count by Event Relationship (Not Broken Down by Emotion)"
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
p = plt_event_cnt2(dat, "area_of_contact")
# save plot
plt_name = "Event Count by Area of Contact (Not Broken Down by Emotion)"
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
### count of events by product size (Not Broken Down by Emotion) ######
# plot
p = plt_event_cnt2(dat, "product_size")
# save plot
plt_name = "Event Count by Product Size (Not Broken Down by Emotion)"
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
ggplts = plt_avg_intensity2(dat, "study_arm", barlab_at_top=T)
gg_avg = ggplts[["plts_avg"]]
gg_pct = ggplts[["plts_pct"]]
# save plot
plt_name = "Avg Emotion Intensity by Study Arm (Not Broken Down by Emotion)"
ggsave(plot=gg_avg, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
plt_name = "Percent of Emotions by Study Arm (Not Broken Down by Emotion)"
ggsave(plot=gg_pct, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
## avg intensity & pct of emotions by event relationship (Not Broken Down by Emotion) ###
# plot
ggplts = plt_avg_intensity2(dat, "event_relationship", barlab_at_top=T)
gg_avg = ggplts[["plts_avg"]]
gg_pct = ggplts[["plts_pct"]]
# save plot
plt_name = "Avg Emotion Intensity by Event Relationship (Not Broken Down By Emotion)"
ggsave(plot=gg_avg, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
plt_name = "Percent of Emotions by Event Relationship (Not Broken Down By Emotion)"
ggsave(plot=gg_pct, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
ggplts = plt_avg_intensity2(dat, "area_of_contact", barlab_at_top=T)
gg_avg = ggplts[["plts_avg"]]
gg_pct = ggplts[["plts_pct"]]
# save plot (ignore "None (for image)")
plt_name = "Avg Emotion Intensity by Area of Contact (Not Broken Down By Emotion)"
ggsave(plot=gg_avg, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
plt_name = "Percent of Emotions by Area of Contact (Not Broken Down By Emotion)"
ggsave(plot=gg_pct, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
ggplts = plt_avg_intensity2(dat, "product_size", barlab_at_top=T)
gg_avg = ggplts[["plts_avg"]]
gg_pct = ggplts[["plts_pct"]]
# save plot
plt_name = "Avg Emotion Intensity by Product Size (Not Broken Down By Emotion)"
ggsave(plot=gg_avg, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
plt_name = "Percent of Emotions by Product Size (Not Broken Down By Emotion)"
ggsave(plot=gg_pct, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
tbl = prep_data4(dat, "event")
plt = mk_barplot(tbl)
plt_name = "Overall Distribution of Events"
p = barplt(tbl, xvar="event", yvar="pct", fillby="event", ylab="percent",
main=plt_name, barlab="pct", barlab_size=4, barlab_at_top=T,
barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.5, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# distribution of study arm
tbl = prep_data4(dat, "study_arm")
plt = mk_barplot(tbl)
plt_name = "Overall Distribution of Study Arm"
p = barplt(tbl, xvar="study_arm", yvar="pct", fillby="study_arm", ylab="percent",
main=plt_name, barlab="pct", barlab_size=4, barlab_at_top=T,
barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.7, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
tbl = prep_data4(dat, "event_relationship")
plt = mk_barplot(tbl)
plt_name = "Overall Distribution of Event Relationship"
p = barplt(tbl, xvar="event_relationship", yvar="pct",
fillby="event_relationship", ylab="percent",
main=plt_name, barlab="pct", barlab_size=4, barlab_at_top=T,
barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=1, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
tbl = prep_data4(dat, "area_of_contact")
plt = mk_barplot(tbl)
plt_name = "Overall Distribution of Area of Contact"
p = barplt(tbl, xvar="area_of_contact", yvar="pct", fillby="area_of_contact",
ylab="percent", main=plt_name, barlab="pct", barlab_size=4,
barlab_at_top=T, barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.7, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
tbl = prep_data4(dat, "treatment")
plt = mk_barplot(tbl)
plt_name = "Overall Distribution of Treatment"
p = barplt(tbl, xvar="treatment", yvar="pct", fillby="treatment", ylab="percent",
main=plt_name, barlab="pct", barlab_size=4, barlab_at_top=T,
barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.7, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
tbl = prep_data4(dat, "product_size")
plt = mk_barplot(tbl)
plt_name = "Overall Distribution of Product Size"
p = barplt(tbl, xvar="product_size", yvar="pct", fillby="product_size",
ylab="percent", main=plt_name, barlab="pct", barlab_size=4,
barlab_at_top=T, barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=1, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
tbl = prep_data5(dat, "event")
plt = mk_barplot(tbl)
plt_name = "Percent of Unique Subjects by Event"
p = barplt(tbl, xvar="event", yvar="pct", fillby="event", ylab="percent",
main=plt_name, barlab="pct", barlab_size=4, barlab_at_top=T,
barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.7, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# percent of unique subjects by study arm
tbl = prep_data5(dat, "study_arm")
plt = mk_barplot(tbl)
plt_name = "Percent of Unique Subjects by Study Arm"
p = barplt(tbl, xvar="study_arm", yvar="pct", fillby="study_arm", ylab="percent",
main=plt_name, barlab="pct", barlab_size=4, barlab_at_top=T,
barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.7, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
tbl = prep_data5(dat, "event_relationship")
plt = mk_barplot(tbl)
plt_name = "Percent of Unique Subjects by Event Relationship"
p = barplt(tbl, xvar="event_relationship", yvar="pct",
fillby="event_relationship", ylab="percent", main=plt_name,
barlab="pct", barlab_size=4, barlab_at_top=T, barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=1, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# percent of unique subjects by area of contact
tbl = prep_data5(dat, "area_of_contact")
plt = mk_barplot(tbl)
plt_name = "Percent of Unique Subjects by Area of Contact"
p = barplt(tbl, xvar="area_of_contact", yvar="pct", fillby="area_of_contact",
ylab="percent", main=plt_name, barlab="pct", barlab_size=4,
barlab_at_top=T, barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.7, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
tbl = prep_data5(dat, "treatment")
plt = mk_barplot(tbl)
plt_name = "Percent of Unique Subjects by Treatment"
p = barplt(tbl, xvar="treatment", yvar="pct", fillby="treatment", ylab="percent",
main=plt_name, barlab="pct", barlab_size=4, barlab_at_top=T,
barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=0.7, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
# percent of unique subjects by product size
tbl = prep_data5(dat, "product_size")
plt = mk_barplot(tbl)
plt_name = "Percent of Unique Subjects by Product Size"
p = barplt(tbl, xvar="product_size", yvar="pct", fillby="product_size",
ylab="percent", main=plt_name, barlab="pct", barlab_size=4,
barlab_at_top=T, barlab_use_pct=T)
p = scale_axis(p, use_pct=T, pct_max=1, pct_jump=0.1)
ggsave(plot=p, filename=file.path(plt_path, paste(plt_name, "png", sep=".")))
ggplts = plt_avg_intensity(dat, "area_of_contact", barlab_at_top=T)
gg_avg = ggplts[["plts_avg"]]
gg_pct = ggplts[["plts_pct"]]
# save plot (ignore the last plot, which is for "None (for image)")
length(gg_avg)
plt_name = "Avg Emotion Intensity by Area of Contact"
save3ggplt(gg_avg, plt_name, plt_path)
length(gg_pct)
plt_name = "Percent of Emotions by Area of Contact"
save3ggplt(gg_pct, plt_name, plt_path)
?ezplot::mk_boxplot()
library(ezplot)
?mk_boxplot
library(devtools)
proj_path = file.path(Sys.getenv("HOME"), "openCPU/apps")
setwd(file.path(proj_path, "phph"))
document()
install.packages("/Users/gmlang/openCPU/apps/phph", repos=NULL, type="source")
library(phph)
document()
install.packages("/Users/gmlang/openCPU/apps/phph", repos=NULL, type="source")
library(phph)
library(opencpu)
opencpu$stop()
cleanup()
opencpu$start(2498)
?ggplot2 version
sessionInfo()
document()
install.packages("/Users/gmlang/openCPU/apps/phph", repos=NULL, type="source")
library(phph)
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
